<!-- Include jQuery and DataTables CSS and JS files -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function () {
        // Initialize DataTable
        $('.table').DataTable();
    });
</script>



<div class="container" style="color: black;background-color: white;">
    <h2>All malware <a href="/add-new-malware" style="color: rgb(112, 102, 102)">(Add New)</a></h2>
    <table class="table">
        <thead>
            <tr>
                <th>Id</th>
                <th>Hash</th>
                <th>Size</th>
                <th>Type</th>
                <th>Category</th>
                <th>Status</th>
                <th>Created By</th>
                <th>Created At</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% for (let i=0; i < malware.length; i++) { %>
                <tr>
                    <td>
                        <%= malware[i].MalwareSample_id %>
                    </td>
                    <td>
                        <%= malware[i].fileHash %>
                    </td>
                    <td>
                        <%= malware[i].fileSize %>
                    </td>
                    <td>
                        <%= malware[i].fileType %>
                    </td>
                    <td>
                        <%= malware[i].malwareCategory %>
                    </td>
                    <td>
                        <%= (malware[i].status===1) ? 'active' : 'inactive' %>
                    </td>
                    <td>
                        <%= malware[i].user_name %>(<%=malware[i].user_id%>)
                    </td>
                    <td>
                        <%= malware[i].created_at %>
                    </td>
                    <td>
                        <!-- See Action -->
                        <a href="#" title="See More" data-toggle="modal"
                            data-target="#myModal-<%= malware[i].MalwareSample_id %>"
                            style="font-size: 30px;color: lightseagreen;">
                            <i class="fa fa-eye"></i>
                        </a>

                        <div class="modal fade" id="myModal-<%= malware[i].MalwareSample_id %>" role="dialog">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">More Details <%= (malware[i].status===1) ? 'active'
                                                : 'inactive' %>
                                        </h5>
                                    </div>
                                    <div class="modal-body" id="role-details">
                                        <!-- Display all fields here properly -->

                                        <p><strong>User Id:</strong>
                                            <%=malware[i].user_id%>
                                        </p>
                                        <p><strong>User Name:</strong>
                                            <%= malware[i].user_name %>
                                        </p>
                                        <p><strong>User Email:</strong>
                                            <%= malware[i].user_email %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>File Hash:</strong>
                                            <%= malware[i].fileHash %>
                                        </p>
                                        <p><strong>File Size:</strong>
                                            <%= malware[i].fileSize %>
                                        </p>
                                        <p><strong>File Type:</strong>
                                            <%= malware[i].fileType %>
                                        </p>
                                        <p><strong>Malware Category:</strong>
                                            <%= malware[i].malwareCategory %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>Incident Date/Time:</strong>
                                            <%= malware[i].dateTime %>
                                        </p>
                                        <p><strong>Incident Description:</strong>
                                            <%= malware[i].descriptionOfIncident %>
                                        </p>
                                        <p><strong>Threat Level:</strong>
                                            <%= malware[i].threatLevel %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>IP Address:</strong>
                                            <%= malware[i].ipAddress %>
                                        </p>
                                        <p><strong>Domain Name:</strong>
                                            <%= malware[i].domainName %>
                                        </p>
                                        <p><strong>Url:</strong>
                                            <%= malware[i].url %>
                                        </p>
                                        <p><strong>Registry Key:</strong>
                                            <%= malware[i].registryKey %>
                                        </p>
                                        <p><strong>File Path:</strong>
                                            <%= malware[i].filePath %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>Behavior Description:</strong>
                                            <%= malware[i].behaviorDescription %>
                                        </p>
                                        <p><strong>System Calls/API Functions:</strong>
                                            <%= malware[i].systemCallsOrAPIFunctions %>
                                        </p>
                                        <p><strong>Registry Modifications:</strong>
                                            <%= malware[i].registryModifications %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>YARA Rules:</strong>
                                            <%= malware[i].YARARules %>
                                        </p>
                                        <p><strong>Patch Information:</strong>
                                            <%= malware[i].patchInformation %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>Actor Name/Alias:</strong>
                                            <%= malware[i].actorNameOrAlias %>
                                        </p>
                                        <p><strong>Motivation:</strong>
                                            <%= malware[i].motivation %>
                                        </p>
                                        <p><strong>TTPs:</strong>
                                            <%= malware[i].TTPs %>
                                        </p>
                                        <p><strong>knownAffiliations:</strong>
                                            <%= malware[i].knownAffiliations %>
                                        </p>
                                        <br style="border: 3px solid black;">
                                        <p><strong>Vulnerability Type:</strong>
                                            <%= malware[i].vulnerabilityType %>
                                        </p>
                                        <p><strong>Affected Software/Component:</strong>
                                            <%= malware[i].affectedSoftwareOrSystemComponent %>
                                        </p>
                                        <p><strong>CVE_ID:</strong>
                                            <%= malware[i].CVE_ID %>
                                        </p>
                                        <p><strong>patch Status:</strong>
                                            <%= malware[i].patchStatus %>
                                        </p>

                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">OK</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% if(role_id==1){ %>
                            <!-- Edit Action -->
                            <a href="/edit-malware/<%= malware[i].	MalwareSample_id %>" title="Edit"
                                style="font-size: 30px;color: green;">
                                <i class="fa fa-edit"></i>
                            </a>
                            <!-- Delete Action -->
                            <a href="/delete-malware/<%= malware[i].	MalwareSample_id %>" title="Delete"
                                style="font-size: 30px;color: red;"
                                onclick="return confirm('Are you sure you want to delete this incident?')">
                                <i class="fa fa-trash"></i>
                            </a>
                            <% } %>
                    </td>
                </tr>
                <% } %>
        </tbody>
    </table>
</div>