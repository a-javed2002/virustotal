<div class="container">
    <h2>Edit Malware</h2>
    <form action="/update-malware/<%= malware.MalwareSample_id %>" method="post">
        <div class="form-group">
            <label for="status">Status:</label><br>
            Active &nbsp; <input type="radio" class="" name="status" value="1" <%= malware.status === 1 ? 'checked' : '' %>><br>
            Inactive &nbsp; <input type="radio" class="" name="status" value="0" <%= malware.status === 0 ? 'checked' : '' %>><br>
            <!-- Populate with existing user status -->
            <% if (errors && errors.find(e => e.param === 'status')) { %>
                <p class="text-danger">
                    <%= errors.find(e => e.param === 'status').msg %>
                </p>
            <% } %>
        </div>
        <div class="form-group">
            <label for="fileHash">File Hash:</label>
            <input type="text" class="form-control" required id="fileHash" placeholder="Enter File Hash" name="fileHash" value="<%= malware.fileHash %>"
                >
            <% if (errors && errors.find(e=> e.param === 'fileHash')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'fileHash').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="fileSize">File Size:</label>
            <input type="text" class="form-control" required id="fileSize" placeholder="Enter File Size" name="fileSize" value="<%= malware.fileSize %>"
                >
            <% if (errors && errors.find(e=> e.param === 'fileSize')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'fileSize').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="fileType">File Type:</label>
            <input type="text" class="form-control" required id="fileType" placeholder="Enter File type" name="fileType" value="<%= malware.fileType %>"
                >
            <% if (errors && errors.find(e=> e.param === 'fileType')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'fileType').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="malwareCategory">Malware Category:</label>
            <input type="text" class="form-control" required id="malwareCategory" placeholder="Enter Malware Category" value="<%= malware.malwareCategory %>"
                name="malwareCategory" >
            <% if (errors && errors.find(e=> e.param === 'malwareCategory')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'malwareCategory').msg %>
                </p>
                <% } %>
        </div>

        <div class="thick-white-line"></div>
        <center>
            <h2>Add Incident Report Details</h2>
        </center>
        <div class="form-group">
            <label for="dateTime">Date Time:</label>
            <input type="date" class="form-control" id="dateTime" placeholder="Select Date-Time" value="<%= malware.dateTime%>"
                name="dateTime" >
            <% if (errors && errors.find(e=> e.param === 'dateTime')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'dateTime').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="descriptionOfIncident">Description Of Incident:</label>
            <textarea class="form-control" id="descriptionOfIncident" placeholder="Enter Description" name="descriptionOfIncident" rows="10" ><%= malware.descriptionOfIncident %></textarea>
            <% if (errors && errors.find(e=> e.param === 'descriptionOfIncident')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'descriptionOfIncident').msg %>
                </p>
                <% } %>
        </div> 
        <div class="form-group">
            <label for="threatLevel">Threat Level:</label>
            <input type="text" class="form-control" id="threatLevel" placeholder="Enter Threat Level" value="<%= malware.threatLevel %>"
                name="threatLevel" >
            <% if (errors && errors.find(e=> e.param === 'threatLevel')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'threatLevel').msg %>
                </p>
                <% } %>
        </div>
        <div class="thick-white-line"></div>
        <center>
            <h2>Add Indicators Of Compromise Details</h2>
        </center>
        <div class="form-group">
            <label for="ipAddress">ipAddress:</label>
            <input type="text" class="form-control" id="ipAddress" placeholder="Enter ipAddress" value="<%= malware.ipAddress %>"
                name="ipAddress" >
            <% if (errors && errors.find(e=> e.param === 'ipAddress')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'ipAddress').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="domainName">domainName:</label>
            <input type="text" class="form-control" id="domainName" placeholder="Enter domainName" value="<%= malware.domainName %>"
                name="domainName" >
            <% if (errors && errors.find(e=> e.param === 'domainName')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'domainName').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="url">url:</label>
            <input type="text" class="form-control" id="url" placeholder="Enter url" value="<%= malware.url %>"
                name="url" >
            <% if (errors && errors.find(e=> e.param === 'url')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'url').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="registryKey">registryKey:</label>
            <input type="text" class="form-control" id="registryKey" placeholder="Enter registryKey" value="<%= malware.registryKey %>"
                name="registryKey" >
            <% if (errors && errors.find(e=> e.param === 'registryKey')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'registryKey').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="filePath">filePath:</label>
            <input type="text" class="form-control" id="filePath" placeholder="Enter filePath" value="<%= malware.filePath %>"
                name="filePath" >
            <% if (errors && errors.find(e=> e.param === 'filePath')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'filePath').msg %>
                </p>
                <% } %>
        </div>
        <div class="thick-white-line"></div>
        <center>
            <h2>Add Malicious Behavior Details</h2>
        </center>
        <div class="form-group">
            <label for="behaviorDescription">Description Of Inciden:</label>
            <textarea class="form-control" id="behaviorDescription" placeholder="Enter Description" name="behaviorDescription" rows="10" ><%= malware.behaviorDescription %></textarea>
            <% if (errors && errors.find(e=> e.param === 'behaviorDescription')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'behaviorDescription').msg %>
                </p>
                <% } %>
        </div> 
        <div class="form-group">
            <label for="systemCallsOrAPIFunctions">systemCallsOrAPIFunctions:</label>
            <input type="text" class="form-control" id="systemCallsOrAPIFunctions" placeholder="Enter systemCallsOrAPIFunctions" value="<%= malware.systemCallsOrAPIFunctions %>"
                name="systemCallsOrAPIFunctions" >
            <% if (errors && errors.find(e=> e.param === 'systemCallsOrAPIFunctions')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'systemCallsOrAPIFunctions').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="registryModifications">registryModifications:</label>
            <input type="text" class="form-control" id="registryModifications" placeholder="Enter registryModifications" value="<%= malware.registryModifications %>"
                name="registryModifications" >
            <% if (errors && errors.find(e=> e.param === 'registryModifications')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'registryModifications').msg %>
                </p>
                <% } %>
        </div>
        <div class="thick-white-line"></div>
        <center>
            <h2>Add Mitigation Strategy Details</h2>
        </center>
        <div class="form-group">
            <label for="YARARules">YARARules:</label>
            <input type="text" class="form-control" id="YARARules" placeholder="Enter YARARules" value="<%= malware.YARARules %>"
                name="YARARules" >
            <% if (errors && errors.find(e=> e.param === 'YARARules')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'YARARules').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="patchInformation">patchInformation:</label>
            <input type="text" class="form-control" id="patchInformation" placeholder="Enter patchInformation" value="<%= malware.patchInformation %>"
                name="patchInformation" >
            <% if (errors && errors.find(e=> e.param === 'patchInformation')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'patchInformation').msg %>
                </p>
                <% } %>
        </div>
        <div class="thick-white-line"></div>
        <center>
            <h2>Add Threat Actor Details</h2>
        </center>
        <div class="form-group">
            <label for="actorNameOrAlias">actorNameOrAlias:</label>
            <input type="text" class="form-control" id="actorNameOrAlias" placeholder="Enter actorNameOrAlias" value="<%= malware.actorNameOrAlias %>"
                name="actorNameOrAlias" >
            <% if (errors && errors.find(e=> e.param === 'actorNameOrAlias')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'actorNameOrAlias').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="motivation">motivation:</label>
            <input type="text" class="form-control" id="motivation" placeholder="Enter motivation" value="<%= malware.motivation %>"
                name="motivation" >
            <% if (errors && errors.find(e=> e.param === 'motivation')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'motivation').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="TTPs">TTPs:</label>
            <input type="text" class="form-control" id="TTPs" placeholder="Enter TTPs" value="<%= malware.TTPs %>"
                name="TTPs" >
            <% if (errors && errors.find(e=> e.param === 'TTPs')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'TTPs').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="knownAffiliations">knownAffiliations:</label>
            <input type="text" class="form-control" id="knownAffiliations" placeholder="Enter knownAffiliations" value="<%= malware.knownAffiliations %>"
                name="knownAffiliations" >
            <% if (errors && errors.find(e=> e.param === 'knownAffiliations')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'knownAffiliations').msg %>
                </p>
                <% } %>
        </div>
        <div class="thick-white-line"></div>
        <center>
            <h2>Add Vulnerability Exploited Details</h2>
        </center>
        <div class="form-group">
            <label for="vulnerabilityType">vulnerabilityType:</label>
            <input type="text" class="form-control" id="vulnerabilityType" placeholder="Enter vulnerabilityType" value="<%= malware.vulnerabilityType %>"
                name="vulnerabilityType" >
            <% if (errors && errors.find(e=> e.param === 'vulnerabilityType')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'vulnerabilityType').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="affectedSoftwareOrSystemComponent">affectedSoftwareOrSystemComponent:</label>
            <input type="text" class="form-control" id="affectedSoftwareOrSystemComponent" placeholder="Enter affectedSoftwareOrSystemComponent" value="<%= malware.affectedSoftwareOrSystemComponent %>"
                name="affectedSoftwareOrSystemComponent" >
            <% if (errors && errors.find(e=> e.param === 'affectedSoftwareOrSystemComponent')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'affectedSoftwareOrSystemComponent').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="CVE_ID">CVE_ID:</label>
            <input type="text" class="form-control" id="CVE_ID" placeholder="Enter CVE_ID" value="<%= malware.CVE_ID %>"
                name="CVE_ID" >
            <% if (errors && errors.find(e=> e.param === 'CVE_ID')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'CVE_ID').msg %>
                </p>
                <% } %>
        </div>
        <div class="form-group">
            <label for="patchStatus">patchStatus:</label>
            <input type="text" class="form-control" id="patchStatus" placeholder="Enter patchStatus" value="<%= malware.patchStatus %>"
                name="patchStatus" >
            <% if (errors && errors.find(e=> e.param === 'patchStatus')) { %>
                <p class="text-danger">
                    <%= errors.find(e=> e.param === 'patchStatus').msg %>
                </p>
                <% } %>
        </div>
        <button type="submit" class="btn btn-default form-control" style="margin-bottom: 30px;font-weight: bolder;">Update</button>
        <br>
        <br>
    </form>
</div>